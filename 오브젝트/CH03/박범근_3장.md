# 역할, 책임, 협력
> 객체지향 패러다임의 핵심은 역할, 책임, 협력

## 1. 협력
> 객체들이 어플리케이션의 기능을 구현하기 위해 수행하는 상호작용
- 메시지 전송을 통해서 객체들끼리 상호작용하며 시스템의 기능이라는 목표를 달성
- 메시지를 수신한 객체는 메서드를 실행해 자율적으로 요청에 응답
  - 각 객체가 자신이 갖고 있는 상태와 스스로의 결정으로 행동해는 자율적인 객체가 되어야 함
  - 내부 구현을 **캡슐화** 한다.

## 2. 책임
> 객체가 협력에 참여하기 위해 수행하는 로직, 객체에 의해 정의되는 응집도 있는 행위의 집합
- '무엇을 할 수 있는가' 와 '무엇을 알고 있는가'
- 책임의 관점에서 '아는 것'과 '하는 것'이 밀접하게 연관되어 있음.
- 객체지향 개발에서 가장 중요한 능력은 책임을 능숙하게 소프트웨어 객체에게 할당하는 것
  - 협력이 중요한 이유는 객체에게 할당한 책임을 결정할 수 있는 문맥을 제공하기 때문
  - 적절한 협력이 적절한 책임을 제공하고, 적절한 책임을 적절한 객체에게 할당해야만 단순하고 유연한 설계를 창조가 가능
- 해당 정보를 잘 알고 있는 객체(정보 전문가)에게 책임을 할당하여 협력한다.

### 책임 주도 설계
- 이 처럼 책임을 찾고 책임을 수행할 적절한 객체를 찾아 책임을 할당하는 방식으로 협력을 설계하는 방법
- 시스템 책임을 잘게 쪼개고, 해당 책임을 수행할 객체를 찾고 객체들끼리 메시지를 통한 협력을 통해서 책임을 수행한다.

### 메시지가 객체를 결정한다
- 메시지가 객체를 선택하는 것이 중요
1. 객체가 **최소한의 인터페이스**를 가질 수 있게 됨
  - 필요한 메시지만을 인터페이스로 추가
2. 객체는 **충분히 추상적인 인터페이스**를 가질 수 있게 됨
  - 인터페이스가 "무엇"을 하는지만 노출, "어떻게" 수행하는지는 캡슐화
  - 메시지는 외부의 요청이므로 무엇에 해당하는 인터페이스를 얻을 수 있음

### 행동이 상태를 결정한다
- 객체는 협력에 참여하기 위해 존재한다 => 객체는 협력에 도움이 될 수 있도록 행동을 제공해야 한다.
- 객체의 상태에 초점을 맟주지 말고 행동에 초점을 맞추자.
- **객체의 행동을 먼저 정하고** 이후에 객체의 상태를 정하자
  - 상태부터 정하고 그 후에 상태에 필요한 행동을 정한다? => 상태에 의존적인 행동이 되어 public interface가 변경될 가능성이 높아짐
  - **캡슐화가 저하된다**
- 훌륭한 책임을 얻기 위해선
  - 해당 객체가 협력 안에서 **다른 객체에게 무엇을 제공**해야 하는지, **무엇을 얻어야하는지** 고민해야 함
  - 협력에 초점을 맞추면 객체의 응집도는 높아지고 결합도는 낮아짐

## 3. 역할
### 역할과 협력
- 역할 : 객체가 협력 안에서 수행하는 책임의 집합

ex) 영화 예매 협력 안에서 "예매하라"라는 메시지를 처리
1. 영화를 예매할 수 있는 적절한 역할은 무엇일까?
2. 역할을 수행할 객체로 Screening 인스턴스를 선택

추가로 "가격을 계산하라"라는 메시지 역시 이 역할에 책임이 있는 객체인 Movie를 선택

### 유연하고 재사용 가능한 협력
- 역할을 통해서 유연하고 재사용 가능한 협력을 얻을 수 있음
- "할인을 계산하라"라는 메시지에 대해 외부 객체에게 도움
- 두 가지 종류의 가격 할인 정책이 존재하는 경우 각 객체마다 협력을 개별적으로 만들어야 할까?
  - 코드 중복의 문제가 생김
  - 해결을 위해 **객체**가 아닌 **책임**에 초점을 맞추면 된다.
  - 두 가지 종류의 정책을 "할인 요금을 계산해라"라는 책임을 가진 대표자로 **추상화**하여 변경이 가능하다.
- 책임과 역할을 중심으로 협력을 바라본다면 변경과 확장이 용이한 유연한 설계로 나아갈 수 있다.

### 역할의 구현
- 역할을 구현하는 가장 일반적인 방법은 **추상 클래스와 인터페이스를 사용하는 것**
- 협력의 관점에서 구체 클래스들이 따라야 하는 책임의 집합을 서술한 것
> 역할은 다양한 종류의 객체를 수용할 수 있는 일종의 슬롯이자 구체적인 객체들의 타입을 캡슐화하는 추상화이다. 객체에게 중요한 것은 행동이고 역할은 객체를 추상화해서 객체 자체가 아닌 협력에 초점을 맞출 수 있게 하자.

### 객체 대 역할
- 역할은 객체가 참여할 수 있는 일종의 슬롯이다.
- 그러나 오직 한 종류의 객체만 협력에 참여하는 경우 역할이라는 개념을 고려하는 것이 유용할까?
  - **협력에 참여하는 후보가 여러 종류의 객체**에 의해 수행될 필요가 있다면 **그 후보는 역할**이 되지만
  - **단지 한 종류의 객체만이 협력에 참여할 필요**가 있다면 **후보는 객체**가 된다.
- **협력**은 **역할들의 상호작용**으로 구성되고, 협력을 구성하기 위한 **역할**에 **적합한 객체**가 선택되며, **객체**는 **클래스**를 이용해 구현되고 생성된다.
- 따라서 초반엔, 객체 또는 역할을 구분짓지 말고 적절한 책임과 협력의 큰 그림을 탐색하는 것이 가장 중요한 목표
  - 이후에 책임과 협력을 정제해나가면서 객체로부터 역할을 분리해내자!
> 협력을 구체적인 객체가 아닌, 추상적인 역할의 관점에서 설계한다면 협력이 유연하고 재사용이 가능해진다는 점!

### 역할과 추상화
- 추상화의 장점
1. 추상화 계층만을 이용하면 중요한 정책을 상위 수준에서 단순화할 수 있다는 것
2. 설계가 좀 더 유연해진다는 것

- 역할은 공통의 책임을 바탕으로 객체의 구체적인 종류를 숨기기 때문에 역할을 객체의 추상화로도 볼 수 있다.
- 따라서 추상화가 가지는 두 가지 장점은 협력의 관점에서 역할에도 동일하게 적용이 가능하다.

**첫번째 장점과 연결 지어서**
- 불필요한 세부사항을 생략하고 핵심적인 개념 강조가 가능
- 협력이라는 관점에서는 구체적인 종류나 세부사항이 중요한 것이 아닌, 객체들을 추상화하여 객체 사이의 핵심적인 관계를 파악하는 것이 중요

**두번째 장점과 연결 지어서**
- 역할은 다양한 종류의 객체를 끼워 넣을 수 있는 일종의 슬롯!
- 협력 안에서 동일한 책임을 수행하는 객체들은 동일한 역할을 수행할 수 있기 때문에 대체 가능
  - 따라서 역할은 다양한 환경에서 다양한 객체들을 수용할 수 있게 해주므로 협력을 유연하게 해준다.
  - ex) DiscountPolicy와 DisccountCondition이라는 추상화된 역할 안에서 여러 객체들이 협력에 참여할 수 있었다.

### 배우와 배역
1. 배역은 연극 배우가 특정 연극에서 연기하는 역할
  - "협력"이라는 연극 안에서 특정한 역할을 할당받은 "객체"
2. 배역은 연극이 상영되는 동안에만 존재하는 일시적인 개념
  - 객체는 협력이라는 실행 문맥 안에서 특정한 역할을 수행
3. 연극이 끝나면 연극 배우는 배역이라는 역할을 벗어 버리고 원래의 연극 배우로 돌아옴
  - 객체는 협력이 끝나면 본래 원래의 객체로 돌아옴
4. 서로 다른 배우들이 동일한 배역을 연기할 수 있다.
  - 협력 관점에서 동일한 역할을 수행하는 객체들은 서로 대체 가능함
5. 하나의 배우가 다양한 연극 안에서 서로 다른 배역을 연기할 수 있다.
  - 객체 역시 여러 협력에 참여해서 다양한 역할을 수행할 수 있음

> 협력이라는 문맥 안에서 역할은 특정한 협력에 참여해서 책임을 수행하는 객체의 일부